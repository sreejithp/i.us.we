var app=angular.module("IUsWe",["ngRoute","ui.bootstrap","ajoslin.promise-tracker","dialogs.main"]);app.factory("AdminService",["$q","$timeout","$log","$state","HttpService",function(a,b,c,d,e){var f=function(){return e.get("/foodAvailabilityList").then(function(a){return a})},g=function(){return e.get("/user/listOfContributors").then(function(a){return a})},h=function(){return e.get("/user/listOfVolunteers").then(function(a){return a})},i=function(){return e.get("/user/listOfNeedy").then(function(a){return a})},j=function(a,b){return e.post("/user/assignVolunteerTask",{contributorId:a,needyId:b}).then(function(a){return a})},k=function(a,b,c,d,f){return e.post("/user/createNeedy",{name:a,address:b,totalPeople:c,loc:d,volunteers:f}).then(function(a){return a})};return{getFoodAvailabilityList:f,getListOfContributors:g,getListOfVolunteers:h,getListOfNeedy:i,assignVolunteerTask:j,addNeedy:k}}]),app.factory("HttpService",["$log","$q","$http","$timeout","$state","$sce",function(a,b,c,d,e){var f=window.AppProperties.baseUrl+"/api",g=function(a){return f+a},h=function(a,b,c,d,e){return k("get",a,void 0,b,void 0===c?!0:c,d,e)},i=function(a,b,c,d){return k("post",a,b,c,d,!1)},j=function(a,b,c,d){return k("delete",a,b,c,d,!1)},k=function(d,f,h,i,j,k,l){function m(b){l||a.warn(b)}function n(b){l||a.debug(b)}function o(a,b){l||e.showMessage(a,b)}const p=void 0!=h&&_.isString(h),q=d.toUpperCase()+" "+f+(p?"(raw)":"");var r=b.defer();return c({method:d,cache:k,url:g(f),data:void 0==h?void 0:p?h:$.param(h),params:i,headers:{"Content-Type":p?"application/json":"application/x-www-form-urlencoded"}}).success(function(a){if(a.success?l||(n(q+":success"),n(a)):(m(q+":failure"),m(a)),j)if(a.success===!0)r.resolve(a.result);else{var b="Error ";a.errorMessage&&(b+=" ["+a.errorMessage+"]"),a.errorCode&&(b+=" Code: "+a.errorCode),o(b),n("Not returning data to caller because the call failed"),r.reject(a.errorMessage)}else r.resolve(a)}).error(function(a){a?o(q+" / Failure:"+a,"danger"):o(q+" / Failed","danger"),r.reject(a)}),e.loadingTracker().addPromise(r.promise),r.promise},l=function(a,b,c){return c&&(a[b]=c),a};return{post:i,get:h,httpDelete:j,setParam:l}}]),app.factory("$state",["$log","$location","$rootScope","promiseTracker","$timeout",function(a,b,c,d,e){function f(a){c.authenticatedUser=a}function g(a,b,d){_.find(c.alerts,{msg:a})||(c.alerts.push({type:b,msg:a}),e(function(){c.alerts.length>0&&c.alerts.splice(0,1)},d?d:7e3))}function h(a,b){c.$broadcast(a,b)}return a.debug("$state.init"),c.some=!0,c.loadingTracker=d({activationDelay:500}),c.alerts=[],{broadcastGlobalEvent:h,showMessage:g,setAuthenticatedUser:f,authenticatedUser:function(){return c.authenticatedUser},isLoggedIn:function(){return void 0!=c.authenticatedUser},loadingTracker:function(){return c.loadingTracker}}}]),app.factory("UserService",["$q","$timeout","$log","$state","HttpService",function(a,b,c,d,e){var f=function(a,b){return e.post("/auth/signin",{principal:a,password:b}).then(function(a){return a.success&&d.setAuthenticatedUser(a.result),a})},g=function(a,b,c,f,g,h,i,j){return e.post("/auth/register",{email:a,name:c,password:b,address:f,location:g,userType:0,pledge:h,pledgeDay:i,pledgeWeekDay:j}).then(function(a){return a.success&&d.setAuthenticatedUser(a.result),a})},h=function(a){return e.get("/user/myPickups",{volunteerId:a}).then(function(a){return a})},i=function(a){return e.get("/user/myDeliveries",{volunteerId:a}).then(function(a){return a})},j=function(a,b,c){return e.post("/user/deliveryInfo",{volunteerId:a,needyId:b,comments:c}).then(function(a){return a})},k=function(a){return e.get("/user/deliveryInfo",{userId:a}).then(function(a){return a})},l=function(a){return e.get("/user/pledge",{contributorId:a}).then(function(a){return a})},m=function(a,b){return e.post("/user/foodReady",{contributorId:a,status:b}).then(function(a){return a})};return{register:g,signin:f,getMyPickupPoints:h,getMyDeliveryPoints:i,getMyPledgeForToday:l,getMyDeliveryInfo:k,postDeliveryInfo:j,updateFoodAvailabilityStatus:m}}]),app.controller("HomePageController",["$log","$scope","$routeParams","UserService","$location",function(a,b,c,d,e){b.signup=function(){a.debug("clicked register"),d.register("randomEmail","randomPassword","name","address","location",1,1,1).then(function(b){a.debug(b)})},b.signIn=function(){a.debug("cliced signIn"),d.signin("email","password").then(function(b){a.debug(b)})},b.forgotPassword=function(){a.debug("going away"),e.path("/home")}}]),app.config(["$routeProvider","$locationProvider",function(a,b){b.html5Mode(!0),a.when("/",{templateUrl:"/public/views/page-landing.html",controller:"HomePageController"}).when("/home",{templateUrl:"/public/views/page-landing.html",controller:"HomePageController"}).when("/view2",{templateUrl:"/public/views/view1.html",controller:"View1Ctrl"}).otherwise({redirectTo:"/"})}]);